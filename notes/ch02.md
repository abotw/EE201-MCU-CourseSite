---
title: Ch02
layout: page
parent: Notes
---

# Chapter 2: Lighting up your LED
{:.no_toc}

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

## 2.1 Introduction to the 51 Microcontroller (MPU)

- **Three Main Resources:** An MPU's internal resources consist of three main types:
    - **FLASH (Program Memory/ROM):** Stores the program and retains data even when power is off (non-volatile) 1.
    - **RAM (Data Memory):** Stores temporary data and loses it when power is off (volatile) 2.
    - **SFR (Special Function Registers):** Used to control the MPU's various internal functions and hardware 3.
- **51 Series:** This family of chips is based on the Intel MCS-51 architecture, with different models (e.g., STC89C52RC) primarily varying in the size of their internal resources (e.g., Flash and RAM) 4.
- **Minimum System:** The essential components required for the MPU to function normally. It consists of three elements 5:
    - **Power Circuit:** Provides the operating voltage 6.
    - **Crystal Oscillator Circuit:** Provides the stable clock signal, acting as the MPU's "heart" or time base for all operations 7.
    - **Reset Circuit:** Enables the MPU to return to its initial state and restart the program 8. (Note: External devices like LEDs and buttons are _not_ part of the minimum system 9).
- **Circuit Reading Tip (Network Labels):** In circuit diagrams, identical character labels (known as Network Labels, e.g., `RST` or `VCC`) on different wires indicate that those points are electrically connected, simplifying the drawing 10.

## 2.2 Introduction to the LED

- **Nature and Principle:** An LED (Light-Emitting Diode) is a semiconductor with single-directional conductivity, and it emits light when current flows through it 11.
- **Safety and Protection:** A **current-limiting resistor** is mandatory in the circuit to keep the current within the safe working range (typically 1mA to 20mA), preventing the LED from being destroyed (burnout risk above 20mA) 12.
- **Polarity:** Current must flow from the **Anode (Positive)** to the **Cathode (Negative)** 13. On a through-hole LED, the longer leg is usually the Anode 14.
- **Program Control (Cathode Connection):** When the LED's cathode is connected to an MPU pin (e.g., P0.0), the control logic is:
    - **Light ON:** Set the MPU pin to **Low Level (0V)** to create a voltage difference with the positive supply (VCC) 15.
    - **Light OFF:** Set the MPU pin to **High Level (+5V)**, resulting in no voltage difference across the LED 16.

## 2.3 SFRs and Creating a Keil Project

- **C Language Keywords for Registers:**
    - `sfr`: Declares a full 8-bit Special Function Register for byte-level operations (e.g., `sfr P0 = 0x80;`) 17.
    - `sbit`: Declares a single bit within a register for precise IO control (e.g., `sbit LED = P0^0;`) 18.
- **Registers as Switches:** The core of programming is controlling the hardware by changing the state (0 or 1) of the bits (switches) within the Special Function Registers 19.
- **Default Port State:** Standard 51 ports (P0, P1, P2, P3) all default to a **Reset Value of 1 (High Level)** 20.
- **Keil Project:** The project file organizes all program files (`.c` source code), configuration, and compiler settings, which is essential for proper compilation and operation 21.

## 2.4 Writing the LED Program

- **Program Necessity (Dead Loop):** A **dead loop** (e.g., `while(1);`) must be included at the end of the `main()` function to prevent the program from "running away" (executing unknown instructions in memory) after it finishes its intended task 22.
- **Compilation and Flashing:** The C source code must be **compiled** into a machine-readable **HEX file** (`.hex`) before it can be burned (flashed) onto the MPU 23.
- **Cold Start:** Flashing STC-series MPUs requires a specific procedure called "Cold Start," where the software download is initiated **before** the MPU is powered on 24.

---

### Exam Points for Final Exam

The most critical concepts and definitions for your final exam are:

| **Topic Area**       | **Key Concept**              | **Exam Points (What you must know)**                                                                                                                        |
| -------------------- | ---------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **51 MPU Basics**    | **Three Major Resources** 25 | Define **FLASH/ROM** (program storage, non-volatile), **RAM** (data storage, volatile), and **SFR** (hardware control) 26.                                  |
|                      | **Minimum System** 27        | Identify the three essential components: **Power, Crystal Oscillator, and Reset Circuit**. Know that LEDs/buttons are _not_ included 28.                    |
|                      | **Crystal Oscillator**  29   | Understand its function as the **clock signal** (the MPU's "heart") that synchronizes all operations 30.                                                    |
|                      | **Reset Types**  31          | Name the three types of reset: **Power-on Reset** (automatic), **Manual Reset** (button), and **Program Reset** 32.                                         |
| **Circuit Reading**  | **Network Labels** 33        | Know that identical labels (e.g., `RST`, `VCC`) indicate **electrical connection** between points, regardless of lines being drawn 34.                      |
| **LED Circuit**      | **Current Limiting** 35      | Understand the need for a **current-limiting resistor** to protect the LED from burning out 36. Be able to use Ohm's Law (I=V/R) for basic calculations 37. |
|                      | **LED Polarity**  38         | Identify the **Anode (+)** and **Cathode (-)** and the direction of current flow 39.                                                                        |
| **Programming**      | **SFR Keywords** 40          | Differentiate between the functions of **`sfr`** (byte declaration) and **`sbit`** (bit declaration for precise IO control) 41.                             |
|                      | **IO Control Logic** 42      | Know the control logic for an LED connected to an MPU pin's cathode: **Low Level (0)** = **ON**, **High Level (1)** = **OFF** 43.                           |
|                      | **Dead Loop** 44             | Explain the purpose of the infinite loop (`while(1);` or `while(1){}`) to prevent the program from "running away" after execution 45.                       |
|                      | **Default Port Value** 46    | Know that all 51 MPU ports default to **High Level (1)** upon reset 47.                                                                                     |
| **Software/Process** | **Keil Output** 48           | Understand that the **HEX file** is the executable file that is flashed onto the MPU 49.                                                                    |
|                      | **STC Flashing**  50         | Recall that **Cold Start** (starting download before powering the chip) is required for STC microcontrollers 51.                                            |